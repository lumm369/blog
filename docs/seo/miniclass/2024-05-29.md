---
id: "20240529"
slug: /20240529
title: "20240529"
authors: lumm
---
今晚哥飞小课堂，跟大家讲一下一些用户归因的小知识。

如果我们想知道用户来自于哪里，可以用流量统计。但是如果想知道付费用户来自哪里？是在 PC端还是移动端付费的？这些信息，就需要我们能够对每一位用户进行归因。

通常的做法是在用户表记录一下用户来源，在订单表记录本地订单的设备信息（从 User Agent 可以读取到）。

这样你就可以关联用户表和订单表，查出各个不同渠道来的用户付费转化率怎么样，甚至细分到不同设备平台的转化率是多少。

那么要怎么记录用户来源呢？

最常见的做法是在用户首次打开我们网站时进行染色处理。

如先根据url 里的参数如 ?ref=xxx、?f=xxx 等参数识别用户来源。如果没有这些参数，就看 referer。

总之通过某些方法获取来源信息，然后把来源信息写入 cookie 里。当用户注册后，记录来源信息到用户表。

记录来源还有两种方法，一种是按照最早来源，一种是按照最新来源。

举例，假设一个用户先通过谷歌搜索打开了你网站，之后在你发到即刻的宣传帖子里又点进来了，之后才注册的。

按照最早来源，那么你应该记录该用户从谷歌搜索过来的，按照最新来源，你应该记录来自于即刻。

如果你去投广告，就更是要能够区分不同广告平台，甚至不同的广告计划，这样你就知道到底哪个平台的广告效果好，哪个广告计划的效果好。

我们做基础框架时，如果一开始就考虑到这个需求，把用户来源情况记录好，之后每一个新项目都能够用得上。而不会在需要去分析时才抓瞎，没统计，区分不了数据。

一些可能需要记录的信息：
1. User Agent
可以分析出用户的设备平台（移动端、PC 端、平板）、系统（Windows、macOS、iOS、Android）等信息

2. IP
可以分析出用户所在的地理位置信息（国家、地区、省市）。

3. 时间
可以按照年、年月、年月日、小时（24 小时制）等维度统计。

4. language
用户浏览器首选语言。